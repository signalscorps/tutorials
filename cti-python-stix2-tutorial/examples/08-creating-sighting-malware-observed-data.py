from stix2 import Sighting
from stix2 import FileSystemStore

## Get required Objects previously saved to filesystem source
### https://stix2.readthedocs.io/en/latest/guide/filesystem.html#FileSystemSource

fs = FileSystemStore("tmp/stix2_store")
SCIdentitySDO = fs.get("identity--c73bd6f8-6cd0-4b39-a5ec-81c4461f97fb")
ObservedDataSROofIPv40SCO = fs.get("observed-data--220aadc8-b1d0-42b6-8695-e07fde007588")
Malware0SDOWithGranularMarkings = fs.get("malware--31d2559c-149d-44c1-9fe9-dd8c147031c3")

## Create Sighting between Observed Data and Malware SDOs
### https://stix2.readthedocs.io/en/latest/api/stix2.v21.html?highlight=sighting#stix2.v21.Sighting

SightingSRO = Sighting(
				sighting_of_ref = Malware0SDOWithGranularMarkings,
				observed_data_refs = [ObservedDataSROofIPv40SCO],
				where_sighted_refs = [SCIdentitySDO],
				count = 1,
				created_by_ref = SCIdentitySDO
			)

## Write the to filesystem

fs.add([SightingSRO])

## sighting--c62dde8c-d7bb-4be1-9075-5030a77bff7f created in FS

## Print the object

print(SightingSRO.serialize(pretty=True))